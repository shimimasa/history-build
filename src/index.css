@tailwind base;
@tailwind components;
@tailwind utilities;

@layer components {
  /* アプリ全体のベースレイアウト */
  .hb-app {
    @apply min-h-screen bg-slate-900 text-slate-100 flex flex-col;
  }

  /* ヘッダー + ターン情報 */
  .hb-header {
    @apply border-b border-slate-800 bg-slate-950/90 backdrop-blur;
  }

  .hb-header-inner {
    @apply w-full max-w-6xl mx-auto px-4 py-3 flex items-center justify-between;
  }

  .hb-header-title {
    @apply text-xl font-bold tracking-wide;
  }

  .hb-header-turn {
    @apply flex items-center gap-3 text-sm;
  }

  .hb-pill {
    @apply px-3 py-1 rounded-full bg-slate-800/80 border border-slate-600 text-xs font-semibold;
  }

  /* 上部ステータスバー（アクション/購入/米/知識） */
  .hb-status-row {
    @apply w-full max-w-6xl mx-auto px-4 pb-3 flex gap-4;
  }

  .hb-status-tile {
    @apply flex-1 flex items-center gap-3 px-3 py-2 rounded-xl bg-slate-900/80 border border-slate-700 shadow-md;
  }

  .hb-status-icon {
    @apply w-8 h-8 rounded-full flex items-center justify-center text-lg font-bold bg-slate-800;
  }

  /* 中央ボードレイアウト */
  .hb-main-board {
    @apply flex-1 w-full flex justify-center;
  }

  .hb-board-inner {
    @apply w-full max-w-6xl px-4 py-4 flex gap-4;
  }

  .hb-sidebar {
    @apply w-56 flex-shrink-0 space-y-3;
  }

  .hb-sidebar-panel {
    @apply hb-card text-xs;
  }

  /* 汎用カードコンテナ（Supply/サイドバーなど） */
  .hb-card {
    @apply border border-slate-700 rounded-xl bg-slate-900/80 shadow-lg shadow-black/40 p-3;
  }

  /* サプライボード */
  .hb-supply {
    @apply flex-1 flex flex-col gap-3;
  }

  .hb-supply-grid {
    @apply grid gap-3 grid-cols-2 md:grid-cols-3 lg:grid-cols-4;
  }

  /* 手札バー（sticky bottom） */
  .hb-hand-bar {
    @apply w-full border-t border-slate-800 bg-slate-950/95;
  }

  .hb-hand-inner {
    @apply w-full max-w-6xl mx-auto px-4 pt-2 pb-2;
  }

  .hb-hand-scroll {
    /* 横スクロール前提で高さを抑え、縦方向には伸びないようにする */
    @apply flex gap-3 overflow-x-auto overflow-y-hidden pb-1;
    max-height: 230px; /* 230〜260px の範囲で抑える */
  }

  .hb-hand-card {
    /* 1行に並べやすいように若干コンパクトに */
    @apply shrink-0 min-w-[120px] max-w-[150px] hb-card cursor-pointer transition-transform duration-150;
  }

  .hb-hand-card-selected {
    @apply ring-2 ring-amber-400 shadow-amber-500/50;
  }

  /* 手札カードを少し縮小して高さを抑える */
  .hb-hand-card-wrapper {
    @apply shrink-0;
    transform: scale(0.8);
    transform-origin: top center;
  }

  /* 右下のフェイズボタン */
  .hb-phase-buttons {
    @apply fixed bottom-4 right-4 flex flex-col gap-2 z-40;
  }
}

@layer components {
  /* 全体レイアウト */
  .hb-game-layout {
    @apply h-screen bg-slate-900 text-slate-100 flex flex-col;
  }

  .hb-game-header {
    @apply border-b border-slate-800 bg-slate-950/90 backdrop-blur flex flex-col gap-2;
  }

  .hb-game-header-top {
    @apply w-full max-w-6xl mx-auto px-4 pt-3 flex items-center justify-between;
  }

  .hb-game-title {
    @apply text-xl font-bold tracking-wide;
  }

  .hb-game-status {
    @apply flex items-center gap-2 text-xs;
  }

  .hb-game-resources {
    @apply w-full max-w-6xl mx-auto px-4 pb-3 flex gap-3;
  }

  .hb-resource-badge {
    @apply flex-1 flex items-center justify-between px-3 py-2 rounded-xl bg-slate-900/80 border border-slate-700;
  }

  .hb-resource-label {
    @apply text-xs text-slate-300;
  }

  .hb-resource-value {
    @apply text-lg font-bold;
  }

  /* フェーズバッジ色分け */
  .hb-phase-badge {
    @apply px-3 py-1 rounded-full text-xs font-semibold border;
  }
  .hb-phase-badge-draw { @apply bg-slate-800 border-slate-600 text-slate-100; }
  .hb-phase-badge-resource { @apply bg-amber-900 border-amber-500 text-amber-100; }
  .hb-phase-badge-action { @apply bg-sky-900 border-sky-500 text-sky-100; }
  .hb-phase-badge-buy { @apply bg-emerald-900 border-emerald-500 text-emerald-100; }
  .hb-phase-badge-cleanup { @apply bg-slate-800 border-slate-500 text-slate-100; }

  /* 中央 3 カラム */
  .hb-game-main {
    @apply flex-1 w-full flex justify-center overflow-hidden;
  }

  .hb-column {
    @apply h-full;
  }

  .hb-player-panel {
    @apply w-56 flex-shrink-0 space-y-3 px-4 py-4;
  }

  .hb-center-area {
    @apply flex-1 flex flex-col gap-3 px-0 py-4;
    /* ヘッダー＋手札＋フッターの分を差し引いて、中央カラム全体の高さを制限 */
    max-height: calc(100vh - 260px);
    overflow: hidden;
  }

  .hb-log-panel {
    @apply w-64 flex-shrink-0 space-y-3 px-4 py-4;
  }

  @screen md {
    .hb-game-main {
      @apply grid;
      grid-template-columns: 220px minmax(0, 1fr) 260px;
      column-gap: 16px;
    }
  }

  /* サプライエリア */
  .hb-supply-area {
    @apply flex-1;
    overflow-y: auto;
    padding-right: 4px;
  }

  .hb-supply-area-grid {
    @apply grid gap-3 grid-cols-2 md:grid-cols-3 xl:grid-cols-4;
  }

  /* プレイエリア */
  .hb-play-area {
    @apply mt-2;
    /* サプライスクロールで押しつぶされないよう固定高さ扱いに */
    flex-shrink: 0;
  }

  .hb-play-area-inner {
    @apply w-full;
  }

  .hb-play-rows {
    @apply flex flex-col gap-3;
  }

  .hb-play-cards {
    @apply flex flex-wrap gap-2;
  }

  .hb-play-empty {
    @apply text-[11px] text-slate-400;
  }

  /* BUY フェーズ用にプレイエリアをコンパクトにする */
  .hb-play-area-compact {
    max-height: 140px;
    overflow-y: auto;
  }

  /* 手札エリア（自分のカード感を出す） */
  .hb-hand-area {
    @apply border-t border-slate-800 bg-slate-950/95;
    flex-shrink: 0;
    max-height: 260px; /* 手札エリア全体の上限高さ */
  }

  .hb-hand-area-inner {
    @apply w-full max-w-6xl mx-auto px-4 pt-2 pb-2;
    height: 100%;
  }

  .hb-hand-header {
    @apply flex items-center justify-between border-b border-slate-800 pb-1 mb-2;
  }

  .hb-hand-row {
    @apply flex justify-center gap-2 overflow-x-auto overflow-y-hidden pb-1;
    height: 200px; /* カードの見せる高さ */
  }

  .hb-hand-empty {
    @apply py-3 text-xs text-slate-300;
  }

  /* フッター（操作ボタン） */
  .hb-footer {
    @apply border-t border-slate-800 bg-slate-950/90;
    flex-shrink: 0;
  }

  .hb-footer-inner {
    @apply w-full max-w-6xl mx-auto px-4 py-2 flex justify-end;
  }

  .hb-footer-buttons {
    @apply flex gap-2;
  }

  .hb-footer-button {
    @apply px-3 py-2 text-xs rounded-full border transition-colors;
  }

  .hb-footer-button-primary {
    @apply bg-sky-600 text-white border-sky-500 hover:bg-sky-500;
  }

  .hb-footer-button-secondary {
    @apply bg-slate-800 text-slate-100 border-slate-600 hover:bg-slate-700;
  }

  .hb-footer-button-muted {
    @apply bg-slate-900 text-slate-500 border-slate-700;
  }

  .hb-footer-button:disabled {
    @apply opacity-50 cursor-not-allowed;
  }

  /* 右カラム: ログ / ヘルプ */
  .hb-log {
    @apply text-[11px] space-y-2;
  }

  .hb-help-panel {
    @apply text-[11px];
  }

  /* シンプルなレスポンシブ（幅が狭いとき右パネルを下に） */
  @media (max-width: 900px) {
    .hb-game-main {
      @apply flex flex-col;
    }
    .hb-log-panel {
      @apply order-last w-full;
    }
  }

  /* サプライカード（通常） */
  .hb-supply-card {
    @apply hb-card p-3;
  }

  /* サプライカード（コンパクト表示） */
  .hb-supply-card-compact {
    @apply hb-card p-2;
    max-width: 180px;
    max-height: 260px;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  .hb-supply-card-compact .hb-card-view {
    width: 180px;
  }

  .hb-supply-card-compact .hb-card-frame {
    padding: 6px 6px 8px;
  }

  .hb-supply-card-compact .hb-card-view-text {
    font-size: 0.7rem;
    -webkit-line-clamp: 3;
  }

  /* サプライカード選択時の軽いハイライト */
  .hb-supply-card-selected {
    @apply ring-2 ring-sky-400 shadow-sky-500/40;
  }
}